<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>UltraTax Labeler</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
      .nav { position: sticky; top: 0; background: #fff; border-bottom: 1px solid #e5e7eb; padding: .6rem 1rem; margin: -2rem -2rem 1rem -2rem; z-index: 10; display:flex; gap:1rem; }
      .nav a { text-decoration: none; color: #2563eb; font-weight: 600; }
      .flash { background: #fff3cd; padding: .5rem .75rem; border: 1px solid #ffeeba; margin-bottom: 1rem; }
      .card { border: 1px solid #ddd; padding: 1rem; border-radius: 6px; max-width: 640px; }
      .list { margin-top: 1rem; }
      a { text-decoration: none; color: #2563eb; }
    </style>
  </head>
  <body>
    <div class="nav">
      <a href="{{ url_for('index') }}" title="Upload a PDF and generate labels">Upload</a>
      <a href="{{ url_for('curated') }}" title="Review curated dataset, build embeddings, manage versions">Curated</a>
      <a href="{{ url_for('help_page') }}" title="How to use this app">Help</a>
    </div>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for m in messages %}<div class="flash">{{ m }}</div>{% endfor %}
      {% endif %}
    {% endwith %}

    <div class="card">
      <h2>Upload PDF</h2>
      <form action="{{ url_for('upload') }}" method="post" enctype="multipart/form-data">
        <div style="margin-bottom:.5rem;">
          <input type="file" accept="application/pdf" name="pdf" required>
        </div>
        <label style="display:flex; align-items:center; gap:.5rem; margin:.5rem 0;">
          <input type="checkbox" name="ultratax_mode" value="1">
          Apply UltraTax P1/P2 normalization
        </label>
        <button type="submit">Generate Mapping</button>
      </form>

      {% if existing %}
        <div class="list">
          <h3>Existing mappings</h3>
          <ul>
            {% for name in existing %}
              <li>
                <a href="{{ url_for('edit', stem=name, name=name) }}">{{ name }}</a>
                â€¢ <a href="{{ url_for('download', filename=name) }}">download</a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    </div>
  </body>
  </html>
